<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>R-ggplot</title>
  <meta name="description" content="R-ggplot" />
  <meta name="generator" content="bookdown 0.17 and GitBook 2.6.7" />

  <meta property="og:title" content="R-ggplot" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="R-ggplot" />
  
  
  

<meta name="author" content="高文欣" />


<meta name="date" content="2020-03-07" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  


<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path=""><a href="#序言"><i class="fa fa-check"></i>序言</a></li>
<li class="chapter" data-level="1" data-path=""><a href="#ggplot2学习笔记1"><i class="fa fa-check"></i><b>1</b> ggplot2学习笔记1</a><ul>
<li class="chapter" data-level="1.1" data-path=""><a href="#ggplot2分层次绘图"><i class="fa fa-check"></i><b>1.1</b> ggplot2分层次绘图</a></li>
<li class="chapter" data-level="1.2" data-path=""><a href="#ggplot2绘图组件"><i class="fa fa-check"></i><b>1.2</b> ggplot2绘图组件</a></li>
<li class="chapter" data-level="1.3" data-path=""><a href="#data"><i class="fa fa-check"></i><b>1.3</b> data</a></li>
<li class="chapter" data-level="1.4" data-path=""><a href="#aes"><i class="fa fa-check"></i><b>1.4</b> aes()</a></li>
<li class="chapter" data-level="1.5" data-path=""><a href="#factor"><i class="fa fa-check"></i><b>1.5</b> factor</a></li>
<li class="chapter" data-level="1.6" data-path=""><a href="#fill属性"><i class="fa fa-check"></i><b>1.6</b> fill属性</a></li>
<li class="chapter" data-level="1.7" data-path=""><a href="#geom_xxx"><i class="fa fa-check"></i><b>1.7</b> geom_xxx</a></li>
<li class="chapter" data-level="1.8" data-path=""><a href="#geom_jitter"><i class="fa fa-check"></i><b>1.8</b> geom_jitter()</a></li>
<li class="chapter" data-level="1.9" data-path=""><a href="#scale"><i class="fa fa-check"></i><b>1.9</b> scale</a></li>
<li class="chapter" data-level="1.10" data-path=""><a href="#常见scale"><i class="fa fa-check"></i><b>1.10</b> 常见scale</a></li>
<li class="chapter" data-level="1.11" data-path=""><a href="#坐标轴"><i class="fa fa-check"></i><b>1.11</b> 坐标轴</a></li>
<li class="chapter" data-level="1.12" data-path=""><a href="#facet"><i class="fa fa-check"></i><b>1.12</b> facet</a></li>
<li class="chapter" data-level="1.13" data-path=""><a href="#为何使用ggplot"><i class="fa fa-check"></i><b>1.13</b> 为何使用ggplot</a></li>
<li class="chapter" data-level="1.14" data-path=""><a href="#wide函数将宽面板变成长面板"><i class="fa fa-check"></i><b>1.14</b> wide函数，将宽面板，变成长面板</a></li>
<li class="chapter" data-level="1.15" data-path=""><a href="#qplot"><i class="fa fa-check"></i><b>1.15</b> qplot</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path=""><a href="#ggplot学习笔记2"><i class="fa fa-check"></i><b>2</b> ggplot学习笔记2</a><ul>
<li class="chapter" data-level="2.1" data-path=""><a href="#stats"><i class="fa fa-check"></i><b>2.1</b> stats</a></li>
<li class="chapter" data-level="2.2" data-path=""><a href="#stat_smooth"><i class="fa fa-check"></i><b>2.2</b> stat_smooth</a></li>
<li class="chapter" data-level="2.3" data-path=""><a href="#group"><i class="fa fa-check"></i><b>2.3</b> group</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R-ggplot</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="header">
<h1 class="title">R-ggplot</h1>
<p class="author"><em>高文欣</em></p>
<p class="date"><em>2020-03-07</em></p>
</div>
<div id="序言" class="section level1 unnumbered">
<h1>序言</h1>
<p>R绘图神器-ggplot</p>

</div>
<div id="ggplot2学习笔记1" class="section level1">
<h1><span class="header-section-number"> 1</span> ggplot2学习笔记1</h1>
<p>R 可视化学习笔记</p>
<p>记参数挺费劲的，还是用的时候查官方文档吧，现在记个大概就行吧~</p>
<div id="ggplot2分层次绘图" class="section level2">
<h2><span class="header-section-number">1.1</span> ggplot2分层次绘图</h2>
<ul>
<li>把绘图与数据分离，把数据相关的绘图与数据无关的绘图分离，按图层作图。ggplot2可以把绘图拆分成多个图层，且能够按照顺序创建多重图形</li>
<li>使用ggplot2包创建图形时，每个图形都是由函数ggplot()创建的，提供绘图的数据和映射
<ul>
<li>数据（data）：数据框对象</li>
<li>映射（mapping）：由aes()函数来设置映射</li>
</ul></li>
</ul>
</div>
<div id="ggplot2绘图组件" class="section level2">
<h2><span class="header-section-number">1.2</span> ggplot2绘图组件</h2>
<p>列几种常见的部件其余可以参考官方文档</p>
<ul>
<li>几何对象(geom)</li>
<li>统计变换(stats)</li>
<li>标度(scale)</li>
<li>坐标系(coord)</li>
<li>分面(facet)</li>
<li>主题(theme)</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1">knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="st">&quot;./figs/01.png&quot;</span>)</a></code></pre></div>
<p><img src="figs/01.png" width="636" /></p>
<p>这些组件之间是通过“+”， 以图层(layer)的方式来粘合构图的，可以这样理解ggplot2中的图层：每个图层可以代表一个图形组件， 这些图形组件以图层的方式叠加在一起构成一个绘图的整体，在每个图层中的图形组件又可以分别设定数据、映射或其他相关参数，因此组件之间又是具有相对独立性的。越后面的图层越高。
<strong>例如</strong></p>
</div>
<div id="data" class="section level2">
<h2><span class="header-section-number">1.3</span> data</h2>
<p>数据和映射</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> <span class="ot">NULL</span>, <span class="dt">mapping =</span> <span class="kw">aes</span>())</a></code></pre></div>
<ul>
<li>data： 用于指定要用到的数据源，必须使<strong>数据框类型</strong></li>
</ul>
</div>
<div id="aes" class="section level2">
<h2><span class="header-section-number">1.4</span> aes()</h2>
<p>用来设定图形属性的</p>
<ul>
<li><p>mapping：使用aes()函数指定每个变量的角色，除x和y之外的其他参数，例如，size、color、shape等，必须采用name=value的形式。</p></li>
<li><p>在ggplot中设置的映射是默认映射关系，其他图层中可以继承该映射关系，或修改映射关系。也就是说，ggplot设置是全局的，其他图层可以继承或者进行修改<a href="http://www.360doc.com/content/19/0329/14/52645714_825079033.shtml">参考案例</a></p></li>
<li><p>aes()中常见属性包括</p>
<ul>
<li>x和y：用于指定x轴和y轴的变量</li>
<li>color：映射点或线的颜色</li>
<li>fill：映射填充区域的颜色</li>
<li>linetype：映射图形的线形(1=实线、2=虚线、3=点、4=点破折号、5=长破折号、6=双破折号)</li>
<li>size：点的尺寸和线的宽度</li>
<li>shape：映射点的形状</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="st">&quot;./figs/02.png&quot;</span>)</a></code></pre></div>
<p><img src="figs/02.png" width="688" /></p>
<ul>
<li><p>group：默认情况下ggplot2把所有观测点分为了一组</p>
<ul>
<li><p>如果需要把观测点按指定的因子进行分组处理，必须修改默认的分组设置</p></li>
<li><p>分组也可以通过映射把视觉特征（shape、color、fill、size和linetype等）设置为变量来实现分组，分组通常使用因子来实现，这就要求在数据集中存在因子变量，用于对数据分类，实现图形的分组</p></li>
<li><p>group设置col区分不同属性</p></li>
</ul></li>
</ul>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(wt, mpg,<span class="dt">col=</span>cyl)) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-2" title="2"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">shape=</span><span class="dv">1</span>, <span class="dt">size=</span><span class="dv">4</span>)</a></code></pre></div>
<p><img src="01_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p><strong>区分一下col和fill，一个是空心的，一个是实心的，fill是填充嘛</strong>
举个栗子
## 设置fill区分不同的属性</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(<span class="dt">x =</span> wt, <span class="dt">y =</span> mpg, <span class="dt">fill =</span> cyl)) <span class="op">+</span></a>
<a class="sourceLine" id="cb5-2" title="2"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">shape =</span> <span class="dv">21</span>, <span class="dt">size =</span> <span class="dv">4</span>,<span class="dt">alpha=</span><span class="fl">0.6</span>)</a></code></pre></div>
<p><img src="01_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
</div>
<div id="factor" class="section level2">
<h2><span class="header-section-number">1.5</span> factor</h2>
<p>若变量是连续型的，则需要将变量离散化，因此factor出现了,否则报错Error: A continuous variable can not be mapped to shape</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(<span class="dt">x =</span> mpg, <span class="dt">y =</span> qsec, <span class="dt">col =</span> cyl, <span class="dt">shape =</span> <span class="kw">factor</span>(am), <span class="dt">size =</span> (hp<span class="op">/</span>wt))) <span class="op">+</span></a>
<a class="sourceLine" id="cb6-2" title="2"><span class="st">  </span><span class="kw">geom_point</span>()</a></code></pre></div>
<p><img src="01_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="op">&gt;</span><span class="st"> </span>diamonds</a>
<a class="sourceLine" id="cb7-2" title="2"><span class="co"># A tibble: 1,000 x 10</span></a>
<a class="sourceLine" id="cb7-3" title="3">   carat cut       color clarity depth table price     x     y     z</a>
<a class="sourceLine" id="cb7-4" title="4"> <span class="op">*</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>ord<span class="op">&gt;</span><span class="st">     </span><span class="er">&lt;</span>ord<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>ord<span class="op">&gt;</span><span class="st">   </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>int<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb7-5" title="5"><span class="st"> </span><span class="dv">1</span>  <span class="fl">0.31</span> Ideal     G     VS1      <span class="fl">62.4</span>    <span class="dv">55</span>   <span class="dv">802</span>  <span class="fl">4.35</span>  <span class="fl">4.33</span>  <span class="fl">2.71</span></a>
<a class="sourceLine" id="cb7-6" title="6"> <span class="dv">2</span>  <span class="fl">1.5</span>  Good      G     SI2      <span class="fl">64.3</span>    <span class="dv">57</span>  <span class="dv">8190</span>  <span class="fl">7.29</span>  <span class="fl">7.2</span>   <span class="fl">4.66</span></a>
<a class="sourceLine" id="cb7-7" title="7"> <span class="dv">3</span>  <span class="fl">0.9</span>  Premium   H     VS2      <span class="fl">62.8</span>    <span class="dv">58</span>  <span class="dv">3810</span>  <span class="fl">6.17</span>  <span class="fl">6.13</span>  <span class="fl">3.86</span></a>
<a class="sourceLine" id="cb7-8" title="8"> <span class="dv">4</span>  <span class="fl">1.01</span> Ideal     F     VS2      <span class="fl">60.9</span>    <span class="dv">58</span>  <span class="dv">7411</span>  <span class="fl">6.43</span>  <span class="fl">6.47</span>  <span class="fl">3.93</span></a>
<a class="sourceLine" id="cb7-9" title="9"> <span class="dv">5</span>  <span class="fl">0.33</span> Very Good D     VS1      <span class="fl">63.2</span>    <span class="dv">56</span>  <span class="dv">1109</span>  <span class="fl">4.45</span>  <span class="fl">4.44</span>  <span class="fl">2.81</span></a>
<a class="sourceLine" id="cb7-10" title="10"> <span class="dv">6</span>  <span class="fl">1.08</span> Ideal     G     VS1      <span class="dv">62</span>      <span class="dv">55</span>  <span class="dv">6779</span>  <span class="fl">6.62</span>  <span class="fl">6.57</span>  <span class="fl">4.09</span></a>
<a class="sourceLine" id="cb7-11" title="11"> <span class="dv">7</span>  <span class="fl">1.07</span> Premium   G     SI1      <span class="fl">61.6</span>    <span class="dv">58</span>  <span class="dv">5453</span>  <span class="fl">6.6</span>   <span class="fl">6.56</span>  <span class="fl">4.05</span></a>
<a class="sourceLine" id="cb7-12" title="12"> <span class="dv">8</span>  <span class="fl">0.33</span> Premium   H     VS1      <span class="fl">59.5</span>    <span class="dv">59</span>   <span class="dv">743</span>  <span class="fl">4.53</span>  <span class="fl">4.48</span>  <span class="fl">2.68</span></a>
<a class="sourceLine" id="cb7-13" title="13"> <span class="dv">9</span>  <span class="fl">0.44</span> Ideal     H     IF       <span class="dv">62</span>      <span class="dv">57</span>  <span class="dv">1255</span>  <span class="fl">4.87</span>  <span class="fl">4.91</span>  <span class="fl">3.02</span></a>
<a class="sourceLine" id="cb7-14" title="14"><span class="dv">10</span>  <span class="dv">1</span>    Premium   G     VS1      <span class="fl">58.6</span>    <span class="dv">61</span>  <span class="dv">6989</span>  <span class="fl">6.57</span>  <span class="fl">6.5</span>   <span class="fl">3.83</span></a>
<a class="sourceLine" id="cb7-15" title="15"><span class="co"># ... with 990 more rows</span></a></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="co"># Create the object containing the data and aes layers: dia_plot</span></a>
<a class="sourceLine" id="cb8-2" title="2">dia_plot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(diamonds, <span class="kw">aes</span>(<span class="dt">x =</span> carat, <span class="dt">y =</span> price))</a>
<a class="sourceLine" id="cb8-3" title="3"></a>
<a class="sourceLine" id="cb8-4" title="4"><span class="co"># Add the same geom layer, but with aes() inside</span></a>
<a class="sourceLine" id="cb8-5" title="5">dia_plot <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">color =</span> clarity))</a></code></pre></div>
<p><img src="01_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p><strong>放一组对比代码</strong>查看各个参数的作用</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="co"># Map cyl to size</span></a>
<a class="sourceLine" id="cb9-2" title="2"><span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(<span class="dt">x =</span> wt, <span class="dt">y =</span> mpg, <span class="dt">size =</span> cyl)) <span class="op">+</span></a>
<a class="sourceLine" id="cb9-3" title="3"><span class="st">  </span><span class="kw">geom_point</span>()</a></code></pre></div>
<p><img src="01_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="co"># Map cyl to alpha</span></a>
<a class="sourceLine" id="cb10-2" title="2"><span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(<span class="dt">x =</span> wt, <span class="dt">y =</span> mpg, <span class="dt">alpha =</span> cyl)) <span class="op">+</span></a>
<a class="sourceLine" id="cb10-3" title="3"><span class="st">  </span><span class="kw">geom_point</span>()</a></code></pre></div>
<p><img src="01_files/figure-html/unnamed-chunk-8-2.png" width="672" /></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"><span class="co"># Map cyl to shape </span></a>
<a class="sourceLine" id="cb11-2" title="2"><span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(<span class="dt">x =</span> wt, <span class="dt">y =</span> mpg, <span class="dt">shape =</span> <span class="kw">factor</span>(cyl))) <span class="op">+</span></a>
<a class="sourceLine" id="cb11-3" title="3"><span class="st">  </span><span class="kw">geom_point</span>()</a></code></pre></div>
<p><img src="01_files/figure-html/unnamed-chunk-8-3.png" width="672" /></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"><span class="co"># Map cyl to labels</span></a>
<a class="sourceLine" id="cb12-2" title="2"><span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(<span class="dt">x =</span> wt, <span class="dt">y =</span> mpg, <span class="dt">label =</span> cyl)) <span class="op">+</span></a>
<a class="sourceLine" id="cb12-3" title="3"><span class="st">  </span><span class="kw">geom_text</span>()</a></code></pre></div>
<p><img src="01_files/figure-html/unnamed-chunk-8-4.png" width="672" /></p>
</div>
<div id="fill属性" class="section level2">
<h2><span class="header-section-number">1.6</span> fill属性</h2>
<p>直接使用fill属性设置填充，是无效的，若不在aes里面设置color，需要结合fill和子图层的color,直接在子图层设置color属性值，也是无效的，因此需要分组
<strong>这里需要复习一下数据处理的的gather函数，由宽面板变为长面板</strong></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1">my_color &lt;-<span class="st"> &quot;#4ABEFF&quot;</span></a>
<a class="sourceLine" id="cb13-2" title="2"><span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(<span class="dt">x =</span> wt, <span class="dt">y =</span> mpg)) <span class="op">+</span></a>
<a class="sourceLine" id="cb13-3" title="3"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">color =</span> my_color)</a></code></pre></div>
<p><img src="01_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1"><span class="co"># Set the fill aesthetic; color, size and shape attributes</span></a>
<a class="sourceLine" id="cb14-2" title="2"><span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(<span class="dt">x =</span> wt, <span class="dt">y =</span> mpg, <span class="dt">fill =</span> cyl)) <span class="op">+</span></a>
<a class="sourceLine" id="cb14-3" title="3"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">10</span>, <span class="dt">shape =</span> <span class="dv">23</span>, <span class="dt">color =</span> my_color)</a></code></pre></div>
<p><img src="01_files/figure-html/unnamed-chunk-9-2.png" width="672" /></p>
</div>
<div id="geom_xxx" class="section level2">
<h2><span class="header-section-number">1.7</span> geom_xxx</h2>
<ul>
<li><p>几何对象控制图层的渲染和生成的图像类型，例如，geom_point()会生成散点图，而geom_line会生成折线图。</p>
<ul>
<li>函数ggplot()可以设置图形，但是没有视觉输出，需要使用一个或多个几何函数向图形中添加几何对象（geometric，简写为geom），包括点（point）、线（line）、条（bar）等，而添加几何图形的格式十分简单，通过符号“+”把几何图形添加到plot中</li>
</ul>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1"><span class="kw">ggplot</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb15-2" title="2"><span class="kw">geom_xxx</span>()</a></code></pre></div>
<p><a href="https://ggplot2.tidyverse.org/reference/">ggplot2官方文档geom_xxx</a></p></li>
<li><p>geom_text()添加文本</p></li>
<li><p>geom_bar（）条形图</p>
<ul>
<li>position
geom_bar()里面的位置调整参数
-identity（默认）</li>
<li>jitter</li>
<li>stack 堆叠</li>
<li>fill 堆叠显示百分比</li>
<li>dodge 并列</li>
<li>posn_d overlab 叠加</li>
</ul></li>
<li><p>geom_points() 散点图==scatter</p></li>
</ul>
<p>举个栗子</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1">cyl.am <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb16-2" title="2"><span class="kw">geom_bar</span>(<span class="dt">position=</span><span class="st">&quot;stack&quot;</span>)</a>
<a class="sourceLine" id="cb16-3" title="3"></a>
<a class="sourceLine" id="cb16-4" title="4"><span class="co"># Fill - show proportion</span></a>
<a class="sourceLine" id="cb16-5" title="5">cyl.am <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb16-6" title="6"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">position =</span> <span class="st">&quot;fill&quot;</span>)  </a>
<a class="sourceLine" id="cb16-7" title="7"></a>
<a class="sourceLine" id="cb16-8" title="8"><span class="co"># Dodging - principles of similarity and proximity</span></a>
<a class="sourceLine" id="cb16-9" title="9">cyl.am <span class="op">+</span></a>
<a class="sourceLine" id="cb16-10" title="10"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">position =</span><span class="st">&quot;dodge&quot;</span>) </a>
<a class="sourceLine" id="cb16-11" title="11"></a>
<a class="sourceLine" id="cb16-12" title="12"><span class="co"># Clean up the axes with scale_ functions</span></a>
<a class="sourceLine" id="cb16-13" title="13">val =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;#E41A1C&quot;</span>, <span class="st">&quot;#377EB8&quot;</span>)</a>
<a class="sourceLine" id="cb16-14" title="14">lab =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Manual&quot;</span>, <span class="st">&quot;Automatic&quot;</span>)</a>
<a class="sourceLine" id="cb16-15" title="15">cyl.am <span class="op">+</span></a>
<a class="sourceLine" id="cb16-16" title="16"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb16-17" title="17"><span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="st">&quot;Cylinders&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb16-18" title="18"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="st">&quot;Number&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb16-19" title="19"><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="st">&quot;Transmission&quot;</span>, </a>
<a class="sourceLine" id="cb16-20" title="20">                    <span class="dt">values =</span> val,</a>
<a class="sourceLine" id="cb16-21" title="21">                    <span class="dt">labels =</span> lab)</a></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1"><span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(<span class="dt">x =</span> cyl, <span class="dt">fill =</span> am)) <span class="op">+</span></a>
<a class="sourceLine" id="cb17-2" title="2"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">position =</span> posn_d, <span class="dt">alpha =</span> <span class="fl">0.6</span>)</a></code></pre></div>
<ul>
<li>geom_histgram 柱状图</li>
</ul>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1"><span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(mpg)) <span class="op">+</span></a>
<a class="sourceLine" id="cb18-2" title="2"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">y =</span> ..density..), <span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">fill =</span> <span class="st">&quot;#377EB8&quot;</span>)</a></code></pre></div>
<p><img src="01_files/figure-html/unnamed-chunk-10-1.png" width="672" />
- geom_freqpoly 柱状图的曲线图</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1"><span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(mpg, <span class="dt">color =</span> cyl)) <span class="op">+</span></a>
<a class="sourceLine" id="cb19-2" title="2"><span class="st">  </span><span class="kw">geom_freqpoly</span>(<span class="dt">binwidth =</span> <span class="dv">1</span>)</a></code></pre></div>
<p><img src="01_files/figure-html/unnamed-chunk-11-1.png" width="672" />
- lines
时间序列图
- geom_rect()</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1"><span class="kw">ggplot</span>(economics, <span class="kw">aes</span>(<span class="dt">x =</span> date, <span class="dt">y =</span> unemploy<span class="op">/</span>pop)) <span class="op">+</span></a>
<a class="sourceLine" id="cb20-2" title="2"><span class="st">  </span><span class="kw">geom_rect</span>(<span class="dt">data =</span> recess,</a>
<a class="sourceLine" id="cb20-3" title="3">            <span class="kw">aes</span>(<span class="dt">xmin =</span> begin, <span class="dt">xmax =</span> end, <span class="dt">ymin =</span> <span class="op">-</span><span class="ot">Inf</span>, <span class="dt">ymax =</span> <span class="op">+</span><span class="ot">Inf</span>),</a>
<a class="sourceLine" id="cb20-4" title="4">            <span class="dt">inherit.aes =</span> <span class="ot">FALSE</span>, <span class="dt">fill =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">alpha =</span> <span class="fl">0.2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb20-5" title="5"><span class="st">  </span><span class="kw">geom_line</span>()</a></code></pre></div>
<p><strong>geom_xxx常见参数</strong></p>
<ul>
<li>color：对点、线和填充区域的边界进行着色</li>
<li>fill：对填充区域着色</li>
<li>alpha：演示的透明度，从透明（0）到不透明（1）</li>
<li>linetype：图案的线条（1=实线、2=虚线、3=点、4=点破折号、5=长破折号、6=双破折号）</li>
<li>size：点的尺寸和线的宽度</li>
<li>shape：点的形状（和par()函数的pch参数相同）</li>
<li>position：绘制条形图和点等对象的位置</li>
</ul>
<p>举个栗子</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1"><span class="co"># Scatter plot: clarity (x), carat (y), price (color)</span></a>
<a class="sourceLine" id="cb21-2" title="2"><span class="kw">ggplot</span>(diamonds, <span class="kw">aes</span>(<span class="dt">x =</span> clarity, <span class="dt">y =</span> carat, <span class="dt">color =</span> price)) <span class="op">+</span></a>
<a class="sourceLine" id="cb21-3" title="3"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.5</span>)</a></code></pre></div>
<p><img src="01_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1"><span class="co"># Dot plot with jittering</span></a>
<a class="sourceLine" id="cb22-2" title="2"><span class="kw">ggplot</span>(diamonds, <span class="kw">aes</span>(<span class="dt">x =</span> clarity, <span class="dt">y =</span> carat, <span class="dt">color =</span> price)) <span class="op">+</span></a>
<a class="sourceLine" id="cb22-3" title="3"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.5</span>, <span class="dt">position =</span> <span class="st">&quot;jitter&quot;</span>)</a></code></pre></div>
<p><img src="01_files/figure-html/unnamed-chunk-12-2.png" width="672" />
<strong>设置position之后，明显看清了，因该是调整了刻度</strong></p>
<ul>
<li>binwidth：分箱的宽度</li>
<li>notch：表示方块图是否应该有缺口</li>
<li>sides：地毯图的位置（“b”=底部、“l”=左部、“r”=右部、“bl”=左下部，等)</li>
<li>width：箱线图的宽度
<strong>label and shape are only applicable to categorical data.</strong></li>
</ul>
</div>
<div id="geom_jitter" class="section level2">
<h2><span class="header-section-number">1.8</span> geom_jitter()</h2>
<p>在R中散点图的时候会经常出现，点重合比较严重的现象，这对我们寻找数据规律或者观察数据有很大的干扰。因此R中，可以用geom_jitter()函数来调整，消除点的重合。</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb23-1" title="1">geom_jitter(mapping <span class="op">=</span> NULL, data <span class="op">=</span> NULL, stat <span class="op">=</span> <span class="st">&quot;identity&quot;</span>, position <span class="op">=</span> <span class="st">&quot;jitter&quot;</span>, ..., width <span class="op">=</span> NULL, height <span class="op">=</span> NULL, na.rm <span class="op">=</span> FALSE, show.legend <span class="op">=</span> NA, inherit.aes <span class="op">=</span> TRUE)</a></code></pre></div>
<p>就参数而言，geom_jitter()和其他函数差别不大，特别的两个参数是width,height</p>
<ul>
<li><p>width 用于调节点波动的宽度</p></li>
<li><p>height 用于调节点波动的高度</p></li>
</ul>
<p>例如有一个散点图</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1">knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="st">&quot;./figs/07.png&quot;</span>)</a></code></pre></div>
<p><img src="figs/07.png" width="408" /></p>
<p>经过处理之后，明显不重合了</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1"><span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(<span class="dt">x =</span> mpg, <span class="dt">y =</span> <span class="dv">0</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb25-2" title="2"><span class="st">  </span><span class="kw">geom_jitter</span>()</a></code></pre></div>
<p><img src="01_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1"><span class="co"># 2 - Add function to change y axis limits</span></a>
<a class="sourceLine" id="cb26-2" title="2"><span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(<span class="dt">x =</span> mpg, <span class="dt">y =</span> <span class="dv">0</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb26-3" title="3"><span class="st">  </span><span class="kw">geom_jitter</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb26-4" title="4"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>,<span class="dv">2</span>))<span class="co">#设置y轴起始刻度，这是连续变量刻度</span></a></code></pre></div>
<p><img src="01_files/figure-html/unnamed-chunk-14-2.png" width="672" /></p>
</div>
<div id="scale" class="section level2">
<h2><span class="header-section-number">1.9</span> scale</h2>
<ul>
<li>标度:标度控制着数据到图形属性的映射，更重要的一点是标度将我们的数据转化为视觉上可以感知的东西, 如大小、颜色、位置和形状。所以通过标度可以修改坐标轴和图例的参数
<a href="https://ggplot2.tidyverse.org/reference/index.html#section-scales">scale</a></li>
</ul>
</div>
<div id="常见scale" class="section level2">
<h2><span class="header-section-number">1.10</span> 常见scale</h2>
<ul>
<li>labs()标签 xlab() ylab() ggtitle()</li>
<li>图形选项（颜色、size、形状、线形等）</li>
</ul>
<p>自定义图形选项</p>
<p>scale_colour_manual()
scale_fill_manual()
scale_size_manual()
scale_shape_manual()
scale_linetype_manual()
scale_alpha_manual()
scale_discrete_manual()
- 坐标轴
标度是区分离散和连续变量的，标度用于将连续型、离散型和日期-时间型变量映射到绘图区域，以及构造对应的坐标轴</p>
</div>
<div id="坐标轴" class="section level2">
<h2><span class="header-section-number">1.11</span> 坐标轴</h2>
<p>坐标系统确定x和y美学如何组合以在图中定位元素。默认的坐标系是笛卡尔坐标系，coord_cartesian()，笛卡尔坐标系是最常用的坐标系，函数coord_flip() 用于反转笛卡尔坐标系，把x轴和y轴对调，一般采用默认的额</p>
</div>
<div id="facet" class="section level2">
<h2><span class="header-section-number">1.12</span> facet</h2>
<p><del><strong>这个参数一开始我不太懂是用来做什么的</strong></del></p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1"><span class="kw">facet_grid</span>(<span class="dt">rows =</span> <span class="ot">NULL</span>, <span class="dt">cols =</span> <span class="ot">NULL</span>, <span class="dt">scales =</span> <span class="st">&quot;fixed&quot;</span>,</a>
<a class="sourceLine" id="cb27-2" title="2">  <span class="dt">space =</span> <span class="st">&quot;fixed&quot;</span>, <span class="dt">shrink =</span> <span class="ot">TRUE</span>, <span class="dt">labeller =</span> <span class="st">&quot;label_value&quot;</span>,</a>
<a class="sourceLine" id="cb27-3" title="3">  <span class="dt">as.table =</span> <span class="ot">TRUE</span>, <span class="dt">switch =</span> <span class="ot">NULL</span>, <span class="dt">drop =</span> <span class="ot">TRUE</span>, <span class="dt">margins =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb27-4" title="4">  <span class="dt">facets =</span> <span class="ot">NULL</span>)</a></code></pre></div>
<ul>
<li><p>rows, cols<br />
A set of variables or expressions quoted by vars() and defining faceting groups on the rows or columns dimension. The variables can be named (the names are passed to labeller).
For compatibility with the classic interface, rows can also be a formula with the rows (of the tabular display) on the LHS and the columns (of the tabular display) on the RHS; the dot in the formula is used to indicate there should be no faceting on this dimension (either row or column).
数据框的行列，变量</p></li>
<li><p>scales</p>
<ul>
<li>“fixed” x和y的标度在所用平面中都相同，在不同分面中进行固定</li>
<li>“free_x” 固定x轴，y轴自由变化</li>
<li>“free_y” 固定y轴，x轴自由变化</li>
<li>“free” x和y的标度在每个版面都可以变化</li>
</ul></li>
<li><p>space
If “fixed”, the default, all panels have the same size. If “free_y” their height will be proportional to the length of the y scale; if “free_x” their width will be proportional to the length of the x scale; or if “free” both height and width will vary. This setting has no effect unless the appropriate scales also vary.</p></li>
<li><p>可以根据数据的不同分组, 将图形按照水平或者垂直方向进行分割，同时可以共享x轴或者y轴</p></li>
<li><p>分组和刻面都用于对数据分组，便于观察各自的规律、趋势和模式，不同的是，分组是把图形绘制到一个大的图形中，通过美学特征来区分，而刻面是把图形绘制到不同的网格中。</p></li>
<li><p>刻面是在一个画布上分布多幅图形，这一过程需要先把数据划分为多个子集， 然后把每个子集依次绘制到画布的不同面板中</p>
<ul>
<li>facet_grid()在网格分面
<ul>
<li>根据数据不同可以绘制共用x轴或者y轴的子图，python中的subplots，</li>
</ul></li>
</ul></li>
</ul>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" title="1"><span class="kw">str</span>(iris.tidy)</a>
<a class="sourceLine" id="cb28-2" title="2"></a>
<a class="sourceLine" id="cb28-3" title="3"><span class="co"># Think about which dataset you would use to get the plot shown right</span></a>
<a class="sourceLine" id="cb28-4" title="4"><span class="co"># Fill in the ___ to produce the plot given to the right</span></a>
<a class="sourceLine" id="cb28-5" title="5"><span class="kw">ggplot</span>(iris.tidy, <span class="kw">aes</span>(<span class="dt">x =</span> Species, <span class="dt">y =</span> Value, <span class="dt">col =</span> Part)) <span class="op">+</span></a>
<a class="sourceLine" id="cb28-6" title="6"><span class="st">  </span><span class="kw">geom_jitter</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb28-7" title="7"><span class="st">  </span><span class="kw">facet_grid</span>(. <span class="op">~</span><span class="st"> </span>Measure)</a>
<a class="sourceLine" id="cb28-8" title="8"></a>
<a class="sourceLine" id="cb28-9" title="9"> <span class="kw">str</span>(iris.tidy)</a>
<a class="sourceLine" id="cb28-10" title="10"><span class="st">&#39;data.frame&#39;</span><span class="op">:</span><span class="st">   </span><span class="dv">600</span> obs. of  <span class="dv">4</span> variables<span class="op">:</span></a>
<a class="sourceLine" id="cb28-11" title="11"><span class="st"> </span><span class="er">$</span><span class="st"> </span>Species<span class="op">:</span><span class="st"> </span>Factor w<span class="op">/</span><span class="st"> </span><span class="dv">3</span> levels <span class="st">&quot;setosa&quot;</span>,<span class="st">&quot;versicolor&quot;</span>,..<span class="op">:</span><span class="st"> </span><span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> ...</a>
<a class="sourceLine" id="cb28-12" title="12"> <span class="op">$</span><span class="st"> </span>Part   <span class="op">:</span><span class="st"> </span>chr  <span class="st">&quot;Sepal&quot;</span> <span class="st">&quot;Sepal&quot;</span> <span class="st">&quot;Sepal&quot;</span> <span class="st">&quot;Sepal&quot;</span> ...</a>
<a class="sourceLine" id="cb28-13" title="13"> <span class="op">$</span><span class="st"> </span>Measure<span class="op">:</span><span class="st"> </span>chr  <span class="st">&quot;Length&quot;</span> <span class="st">&quot;Length&quot;</span> <span class="st">&quot;Length&quot;</span> <span class="st">&quot;Length&quot;</span> ...</a>
<a class="sourceLine" id="cb28-14" title="14"> <span class="op">$</span><span class="st"> </span>Value  <span class="op">:</span><span class="st"> </span>num  <span class="fl">5.1</span> <span class="fl">4.9</span> <span class="fl">4.7</span> <span class="fl">4.6</span> <span class="dv">5</span> <span class="fl">5.4</span> <span class="fl">4.6</span> <span class="dv">5</span> <span class="fl">4.4</span> <span class="fl">4.9</span> ...</a></code></pre></div>
<ul>
<li>facet_wrap()将一维面板的丝带缠绕成二维，封装分面，自动分成2x4, 3x2等版块</li>
<li>vars()引用分面变量
<a href="https://blog.csdn.net/weixin_43528109/article/details/83859327">具体可以参考</a>
## theme</li>
</ul>
<p>主题</p>
</div>
<div id="为何使用ggplot" class="section level2">
<h2><span class="header-section-number">1.13</span> 为何使用ggplot</h2>
<p>因为省代码:smile:hahah~
来一个栗子对比一下
- 基础包里面的plot绘图</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" title="1"><span class="co"># Convert cyl to factor (don&#39;t need to change)</span></a>
<a class="sourceLine" id="cb29-2" title="2">mtcars<span class="op">$</span>cyl &lt;-<span class="st"> </span><span class="kw">as.factor</span>(mtcars<span class="op">$</span>cyl)</a>
<a class="sourceLine" id="cb29-3" title="3"></a>
<a class="sourceLine" id="cb29-4" title="4"><span class="co"># Example from base R (don&#39;t need to change)</span></a>
<a class="sourceLine" id="cb29-5" title="5"><span class="kw">plot</span>(mtcars<span class="op">$</span>wt, mtcars<span class="op">$</span>mpg, <span class="dt">col =</span> mtcars<span class="op">$</span>cyl)</a>
<a class="sourceLine" id="cb29-6" title="6"><span class="kw">abline</span>(<span class="kw">lm</span>(mpg <span class="op">~</span><span class="st"> </span>wt, <span class="dt">data =</span> mtcars), <span class="dt">lty =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb29-7" title="7"><span class="kw">lapply</span>(mtcars<span class="op">$</span>cyl, <span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb29-8" title="8">  <span class="kw">abline</span>(<span class="kw">lm</span>(mpg <span class="op">~</span><span class="st"> </span>wt, mtcars, <span class="dt">subset =</span> (cyl <span class="op">==</span><span class="st"> </span>x)), <span class="dt">col =</span> x)</a>
<a class="sourceLine" id="cb29-9" title="9">  })</a></code></pre></div>
<pre><code>## [[1]]
## NULL
## 
## [[2]]
## NULL
## 
## [[3]]
## NULL
## 
## [[4]]
## NULL
## 
## [[5]]
## NULL
## 
## [[6]]
## NULL
## 
## [[7]]
## NULL
## 
## [[8]]
## NULL
## 
## [[9]]
## NULL
## 
## [[10]]
## NULL
## 
## [[11]]
## NULL
## 
## [[12]]
## NULL
## 
## [[13]]
## NULL
## 
## [[14]]
## NULL
## 
## [[15]]
## NULL
## 
## [[16]]
## NULL
## 
## [[17]]
## NULL
## 
## [[18]]
## NULL
## 
## [[19]]
## NULL
## 
## [[20]]
## NULL
## 
## [[21]]
## NULL
## 
## [[22]]
## NULL
## 
## [[23]]
## NULL
## 
## [[24]]
## NULL
## 
## [[25]]
## NULL
## 
## [[26]]
## NULL
## 
## [[27]]
## NULL
## 
## [[28]]
## NULL
## 
## [[29]]
## NULL
## 
## [[30]]
## NULL
## 
## [[31]]
## NULL
## 
## [[32]]
## NULL</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" title="1"><span class="kw">legend</span>(<span class="dt">x =</span> <span class="dv">5</span>, <span class="dt">y =</span> <span class="dv">33</span>, <span class="dt">legend =</span> <span class="kw">levels</span>(mtcars<span class="op">$</span>cyl),</a>
<a class="sourceLine" id="cb31-2" title="2">       <span class="dt">col =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">pch =</span> <span class="dv">1</span>, <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>)</a></code></pre></div>
<p><img src="01_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<p>ggplot绘图</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" title="1"><span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(<span class="dt">x =</span> wt, <span class="dt">y =</span> mpg, <span class="dt">col =</span> cyl)) <span class="op">+</span></a>
<a class="sourceLine" id="cb32-2" title="2"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb32-3" title="3"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb32-4" title="4"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="kw">aes</span>(<span class="dt">group =</span> <span class="dv">1</span>), <span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>, <span class="dt">linetype =</span> <span class="dv">2</span>)</a></code></pre></div>
<p><img src="01_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
</div>
<div id="wide函数将宽面板变成长面板" class="section level2">
<h2><span class="header-section-number">1.14</span> wide函数，将宽面板，变成长面板</h2>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" title="1"><span class="co"># Load the tidyr package</span></a>
<a class="sourceLine" id="cb33-2" title="2"><span class="kw">library</span>(tidyr)</a>
<a class="sourceLine" id="cb33-3" title="3"></a>
<a class="sourceLine" id="cb33-4" title="4"><span class="co"># Add column with unique ids (don&#39;t need to change)</span></a>
<a class="sourceLine" id="cb33-5" title="5">iris<span class="op">$</span>Flower &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(iris)</a>
<a class="sourceLine" id="cb33-6" title="6"></a>
<a class="sourceLine" id="cb33-7" title="7"><span class="co"># Fill in the ___ to produce to the correct iris.wide dataset</span></a>
<a class="sourceLine" id="cb33-8" title="8">iris.wide &lt;-<span class="st"> </span>iris <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb33-9" title="9"><span class="st">  </span><span class="kw">gather</span>(key, value, <span class="op">-</span>Species, <span class="op">-</span>Flower) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb33-10" title="10"><span class="st">  </span><span class="kw">separate</span>(key, <span class="kw">c</span>(<span class="st">&quot;Part&quot;</span>,<span class="st">&quot;Measure&quot;</span>), <span class="st">&quot;</span><span class="ch">\\</span><span class="st">.&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb33-11" title="11"><span class="st">  </span><span class="kw">spread</span>(Measure, value)</a></code></pre></div>
</div>
<div id="qplot" class="section level2">
<h2><span class="header-section-number">1.15</span> qplot</h2>
<p>快速作图，类似与plot</p>

</div>
</div>
<div id="ggplot学习笔记2" class="section level1">
<h1><span class="header-section-number"> 2</span> ggplot学习笔记2</h1>
<div id="stats" class="section level2">
<h2><span class="header-section-number">2.1</span> stats</h2>
<p>增加
统计变换</p>
<p>stat_xxx</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" title="1">knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="st">&#39;./figs/08.png&#39;</span>)</a></code></pre></div>
<p><img src="figs/08.png" width="332" /></p>
<p>这个我还是不知道有啥区别</p>
<ul>
<li><p>统计变换是对数据进行统计，通常以某种方式对数据信息进行汇总,例如通过stat_smooth()添加光滑曲线。</p></li>
<li><p>每一个几何对象都有一个默认的统计变换,并且每一个统计变换都有一个默认的几何对象</p></li>
</ul>
</div>
<div id="stat_smooth" class="section level2">
<h2><span class="header-section-number">2.2</span> stat_smooth</h2>
<ul>
<li><p>对原始数据进行某种统计变换计算，然后在图上表示出来，例如对散点图上加一条<strong>回归线</strong>。</p></li>
<li><p>添加默认曲线</p></li>
<li><p>method 表示指定平滑曲线的统计函数，如lm线性回归, glm广义线性回归, loess多项式回归, gam广义相加模型(mgcv包), rlm稳健回归(MASS包)</p>
<ul>
<li>formula 表示指定平滑曲线的方程，如 y~x, y~poly(x, 2), y~log(2) ，需要与method参数搭配使用</li>
<li>se 表示是否显示平滑曲线的置信区间，默认TRUE显示；level = 0.95</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" title="1"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb35-2" title="2"><span class="co"># Explore the mtcars data frame with str()</span></a>
<a class="sourceLine" id="cb35-3" title="3"><span class="kw">str</span>(mtcars)</a></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    32 obs. of  11 variables:
##  $ mpg : num  21 21 22.8 21.4 18.7 18.1 14.3 24.4 22.8 19.2 ...
##  $ cyl : num  6 6 4 6 8 6 8 4 4 6 ...
##  $ disp: num  160 160 108 258 360 ...
##  $ hp  : num  110 110 93 110 175 105 245 62 95 123 ...
##  $ drat: num  3.9 3.9 3.85 3.08 3.15 2.76 3.21 3.69 3.92 3.92 ...
##  $ wt  : num  2.62 2.88 2.32 3.21 3.44 ...
##  $ qsec: num  16.5 17 18.6 19.4 17 ...
##  $ vs  : num  0 0 1 1 0 1 0 1 1 1 ...
##  $ am  : num  1 1 1 0 0 0 0 0 0 0 ...
##  $ gear: num  4 4 4 3 3 3 3 4 4 4 ...
##  $ carb: num  4 4 1 1 2 1 4 2 2 4 ...</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" title="1"><span class="co"># A scatter plot with LOESS smooth</span></a>
<a class="sourceLine" id="cb37-2" title="2"><span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(<span class="dt">x =</span> wt, <span class="dt">y =</span> mpg)) <span class="op">+</span></a>
<a class="sourceLine" id="cb37-3" title="3"><span class="st">  </span><span class="kw">geom_point</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb37-4" title="4"><span class="st">  </span><span class="kw">geom_smooth</span>()</a></code></pre></div>
<p><img src="02_files/figure-html/unnamed-chunk-2-1.png" width="576" /></p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" title="1"><span class="co"># A scatter plot with an ordinary Least Squares linear model</span></a>
<a class="sourceLine" id="cb38-2" title="2"><span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(<span class="dt">x =</span> wt, <span class="dt">y =</span> mpg)) <span class="op">+</span></a>
<a class="sourceLine" id="cb38-3" title="3"><span class="st">  </span><span class="kw">geom_point</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb38-4" title="4"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method=</span><span class="st">&quot;lm&quot;</span>)</a></code></pre></div>
<p><img src="02_files/figure-html/unnamed-chunk-2-2.png" width="576" /></p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" title="1"><span class="co"># The previous plot, without CI ribbon</span></a>
<a class="sourceLine" id="cb39-2" title="2"><span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(<span class="dt">x =</span> wt, <span class="dt">y =</span> mpg)) <span class="op">+</span></a>
<a class="sourceLine" id="cb39-3" title="3"><span class="st">  </span><span class="kw">geom_point</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb39-4" title="4"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method=</span><span class="st">&quot;lm&quot;</span>,<span class="dt">se=</span><span class="ot">FALSE</span>)</a></code></pre></div>
<p><img src="02_files/figure-html/unnamed-chunk-2-3.png" width="576" /></p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" title="1"><span class="co"># The previous plot, without points</span></a>
<a class="sourceLine" id="cb40-2" title="2"><span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(<span class="dt">x =</span> wt, <span class="dt">y =</span> mpg)) <span class="op">+</span></a>
<a class="sourceLine" id="cb40-3" title="3"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method=</span><span class="st">&quot;lm&quot;</span>,<span class="dt">se=</span><span class="ot">FALSE</span>)</a></code></pre></div>
<p><img src="02_files/figure-html/unnamed-chunk-2-4.png" width="576" />
以下为ggplot2提供的其他统计变换方式，也可以自己写函数基于原始数据进行计算。<a href="https://www.cnblogs.com/Mao1518202/p/11345410.html">CNBLOG</a></p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" title="1"></a>
<a class="sourceLine" id="cb41-2" title="2">stat_abline       stat_contour      stat_identity     stat_summarystat_bin          stat_density      stat_qq           stat_summary2dstat_bin2d        stat_density2d    stat_quantile     stat_summary_hexstat_bindot       stat_ecdf         stat_smooth       stat_uniquestat_binhex       stat_function     stat_spoke        stat_vlinestat_boxplot      stat_hline        stat_sum          stat_ydensity</a></code></pre></div>
</div>
<div id="group" class="section level2">
<h2><span class="header-section-number">2.3</span> group</h2>
<p><a href="https://www.cnblogs.com/nxld/p/6059603.html" class="uri">https://www.cnblogs.com/nxld/p/6059603.html</a></p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" title="1"><span class="co"># 1 - Define cyl as a factor variable</span></a>
<a class="sourceLine" id="cb42-2" title="2"><span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(<span class="dt">x =</span> wt, <span class="dt">y =</span> mpg, <span class="dt">col =</span> <span class="kw">factor</span>(cyl))) <span class="op">+</span></a>
<a class="sourceLine" id="cb42-3" title="3"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb42-4" title="4"><span class="st">  </span><span class="kw">stat_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p><img src="02_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" title="1"><span class="co"># 2 - Plot 1, plus another stat_smooth() containing a nested aes()</span></a>
<a class="sourceLine" id="cb43-2" title="2"><span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(<span class="dt">x =</span> wt, <span class="dt">y =</span> mpg, <span class="dt">col =</span> <span class="kw">factor</span>(cyl))) <span class="op">+</span></a>
<a class="sourceLine" id="cb43-3" title="3"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb43-4" title="4"><span class="st">  </span><span class="kw">stat_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb43-5" title="5"><span class="st">  </span><span class="kw">stat_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>, <span class="kw">aes</span>(<span class="dt">group =</span> <span class="dv">1</span>))</a></code></pre></div>
<p><img src="02_files/figure-html/unnamed-chunk-3-2.png" width="672" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>


    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"],
"google": false,
"instapper": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toolbar": {
"position": "fixed",
"search": false
}
});
});
</script>

</body>

</html>
